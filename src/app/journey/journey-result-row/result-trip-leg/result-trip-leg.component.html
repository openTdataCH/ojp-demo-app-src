<div class="mb-2 d-flex flex-row">
  <div class="flex-grow-1">
    <div
      class="badge leg-pill pill-hover leg-leading-text"
      [ngStyle]="{'background-color': this.legInfoDataModel.legColor}"
      (click)="handleTapOnPill()"
    >{{ this.legInfoDataModel.leadingText }}</div>
  </div>
  <div class="flex-grow-0 leg-right-side">
    <div
      class="badge leg-pill pill-hover bg-primary"
      (click)="handleTapOnPill()"
    >MAP</div>
  </div>
</div>

<div class="mb-2 d-flex flex-row align-items-center">
  <div class="flex-grow-0 leg-left-side">
    <div class="d-flex flex-column leg-icon-wrapper">
      <div class="text-center">
        <img class="leg-icon" src="{{ this.legInfoDataModel.legIconPath }}" />
      </div>
      <div class="text-center">{{ this.legInfoDataModel.distanceText }}</div>
    </div>
  </div>
  
  <div class="flex-grow-1">
    <ng-container
      *ngIf="this.legInfoDataModel.legTemplate == 'walk' then walkingLegTemplate;">
    </ng-container>
    <ng-container
      *ngIf="this.legInfoDataModel.legTemplate == 'timed' then timedLegTemplate;">
    </ng-container>
    <ng-container
      *ngIf="this.legInfoDataModel.legTemplate == 'taxi' then taxiLegTemplate;">
    </ng-container>
  </div>
</div>

<div class="mb-2">
  <div class="border-bottom" style="height: 8px"></div>
</div>

<ng-template #timedLegTemplate>
  <div class="d-flex flex-row">
    <div 
      class="flex-grow-1 leg-location location-hover" 
      (click)="this.handleClickOnLocation('From')"
    >
      <span>{{ this.legInfoDataModel.fromLocationData.locationText }}</span>
      <span *ngIf="this.legInfoDataModel.fromLocationData.platformText">, Platform {{ this.legInfoDataModel.fromLocationData.platformText }}</span>
    </div>
    <div 
      class="flex-grow-0 leg-time leg-right-side">
      <span>{{ this.legInfoDataModel.fromLocationData.timeText }}</span>
      <span class="time-delay">{{ this.legInfoDataModel.fromLocationData.delayText }}</span>
    </div>
  </div>

  <div class="mb-2">
    <div class="border-bottom" style="height: 8px; margin-left: 4px;"></div>
  </div>

  <div class="d-flex flex-row">
    <div 
      class="flex-grow-1 leg-location location-hover"
      (click)="this.handleClickOnLocation('To')"
    >
      <span>{{ this.legInfoDataModel.toLocationData.locationText }}</span>
      <span *ngIf="this.legInfoDataModel.toLocationData.platformText">, Platform {{ this.legInfoDataModel.toLocationData.platformText }}</span>
    </div>
    <div 
      class="flex-grow-0 leg-time leg-right-side">
      <span>{{ this.legInfoDataModel.toLocationData.timeText }}</span>
      <span class="time-delay">{{ this.legInfoDataModel.toLocationData.delayText }}</span>
    </div>
  </div>
</ng-template>

<ng-template #walkingLegTemplate>
  <div class="d-flex flex-row align-items-center">
    <div class="flex-grow-1 leg-location">
      <div class="d-flex flex-column leg-location">
        <div 
          class="location-hover"
          (click)="this.handleClickOnLocation('From')"
        >{{ this.legInfoDataModel.fromLocationData.locationText }}</div>

        <sbb-tooltip svgIcon="kom:arrow-change-horizontal-medium" *ngIf="this.legInfoDataModel.hasGuidance">
          <ul class="tooltip-list">
            <li *ngFor="let guidanceText of this.legInfoDataModel.guidanceTextLines">
              {{ guidanceText }}
            </li>
          </ul>
        </sbb-tooltip>

        <div class="mb-2" *ngIf="this.legInfoDataModel.hasGuidance == false">
          <div class="border-bottom" style="height: 8px; margin-left: 4px; margin-right: 8px;"></div>
        </div>
      
        <div 
          class="location-hover"
          (click)="this.handleClickOnLocation('To')"
        >{{ this.legInfoDataModel.toLocationData.locationText }}</div>
      </div>
    </div>
    <div class="flex-grow-0 leg-time leg-right-side">
      <div>{{ this.legInfoDataModel.durationText }}</div>
    </div>
  </div>
</ng-template>

<ng-template #taxiLegTemplate>
  <div class="d-flex flex-row align-items-center">
    <div class="flex-grow-1 leg-location">
      <div class="d-flex flex-column leg-location">
        <div 
          class="location-hover"
          (click)="this.handleClickOnLocation('From')"
        >{{ this.legInfoDataModel.fromLocationData.locationText }}</div>

        <ul class="booking-arrangement">
          <li *ngFor="let bookingArrangement of this.legInfoDataModel.bookingArrangements">
            Book on <a href="{{ bookingArrangement.infoURL }}" target="_blank">{{ bookingArrangement.agencyName }}</a>
          </li>
        </ul>

        <div 
          class="location-hover"
          (click)="this.handleClickOnLocation('To')"
        >{{ this.legInfoDataModel.toLocationData.locationText }}</div>
      </div>
    </div>
    <div class="flex-grow-0 leg-time leg-right-side">
      <div>{{ this.legInfoDataModel.durationText }}</div>
    </div>
  </div>
</ng-template>